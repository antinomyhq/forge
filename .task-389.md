# Issue 389: Support for `/retry` Command

## Issue Details

**Title:** feat: Support for `/retry`
**Number:** 389
**Author:** tusharmath
**Labels:** forge-just-do-it, ðŸ’Ž Bounty

### Description

**Changes Required**
- This should be a first-class feature supported on the `Api`.
  ```rust
  trait Api {
     fn retry(&self, conversation_id: ConversationId) -> anyhow::Result<MpscStream<Result<AgentMessage<ChatResponse>, anyhow::Error>>>;
  }
  ```

- Idea is that we can pull the last user message from the conversation and convert it to a `ChatRequest` and reinitialize the Orchestrator.
- A new command should be added in `forge_main` that allows the developer to write `/retry` and the execution is retried.
- Make sure we use `TitleFormat` to print a message consistent with the other before retrying is started.

**Technical Requirements**
- Ensure all existing tests pass
- Add new tests wherever required

## Plan

### 1. Understand the Current Implementation

1. Review the existing `Api` trait to understand how it's structured and how to add the new `retry` method
2. Review the conversation storage mechanism to understand how to retrieve the last user message
3. Examine the Orchestrator initialization process to understand how to reinitialize it
4. Review the TitleFormat implementation to understand how to maintain consistency

### 2. Implement `retry` Method in the `Api` Trait

1. Add the `retry` method to the `Api` trait in `crates/forge_api/src/api.rs`
2. Implement the method for all structs that implement the `Api` trait
3. The implementation will:
   - Retrieve the conversation by ID
   - Extract the last user message
   - Convert it to a `ChatRequest`
   - Reinitialize the Orchestrator
   - Return a stream of responses

### 3. Implement `/retry` Command in `forge_main`

1. Add `/retry` command handling in the CLI code in `crates/forge_main/src/`
2. Connect the command to the new `Api::retry` method
3. Use `TitleFormat` to print a consistent message before retrying

### 4. Add Tests

1. Add unit tests for the new `retry` method in the `Api` trait
2. Add integration tests for the `/retry` command
3. Ensure all existing tests pass with the new changes

### 5. Documentation

1. Update documentation to include information about the new `/retry` command
2. Add code comments explaining the implementation details

## Requirements

1. The `/retry` command must work in the CLI
2. The implementation must follow the API design specified in the issue
3. The code must maintain the same style and quality as the rest of the codebase
4. All tests must pass
5. The retry functionality should properly reinitialize the Orchestrator with the last user message
6. Appropriate error handling must be in place
7. The user experience should be consistent with other commands in the CLI

## Implementation Notes

- The retry functionality should handle conversation state correctly
- Edge cases to consider:
  - What happens if there is no previous user message?
  - How to handle errors during retry?
  - How to ensure the conversation context is preserved correctly?
- Performance considerations for retrieving and processing conversation history