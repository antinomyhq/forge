# Issue Details

## Title
Add error tracking to TRACKER with new EventKind

## Description
### Problem
The application currently lacks a mechanism to track errors that occur during runtime. This limits our ability to monitor application health and proactively address issues users are encountering.

### Proposed Solution
Extend the `EventKind` enum to include an `ErrorOccurred` variant that can capture:
- Error type/category
- Error message
- Context (where the error occurred)
- Stack trace (if available)

## Plan

1. **Create an `ErrorDetails` struct** 
   - Add a new struct in the `event.rs` file to store comprehensive error information:
     - Error type/category
     - Error message
     - Context information (module path, file, line)
     - Stack trace when available
     - Timestamp
   - Make this struct serializable and deserializable using Serde

2. **Extend the `EventKind` enum**
   - Add a new variant `ErrorOccurred(ErrorDetails)` to the `EventKind` enum in `event.rs`
   - Update the `name()` and `value()` methods to handle the new variant
   - Ensure proper serialization of the error details

3. **Create helper functions**
   - Implement utility functions to easily create and dispatch error events from anywhere in the codebase
   - Create methods that can extract relevant error information from different error types
   - Add functions to convert common error types into `ErrorDetails`

4. **Implement error tracking integration points**
   - Identify key error handling points in the codebase
   - Add error tracking dispatches at these points
   - Ensure errors are properly captured with appropriate context

5. **Update tests**
   - Add unit tests for the new `ErrorDetails` struct
   - Update existing tests for `EventKind` to include the new variant
   - Add integration tests to verify correct error tracking

6. **Update documentation**
   - Add documentation explaining the error tracking capabilities
   - Document how to use the error tracking features in code
   - Update user-facing documentation about privacy considerations

## Requirements

### Acceptance Criteria
- [ ] New `ErrorOccurred(ErrorDetails)` variant added to `EventKind`
- [ ] `ErrorDetails` struct created to capture detailed error information
- [ ] Update `name()` and `value()` methods to handle the new variant
- [ ] Helper functions created for dispatching error events
- [ ] Maintain current opt-out behavior for tracking
- [ ] Tests added for the new functionality
- [ ] Documentation updated

### Implementation Details
1. The `ErrorDetails` struct should include:
   ```rust
   struct ErrorDetails {
       error_type: String,      // Category/type of error (e.g., "IOError", "NetworkError")
       message: String,         // Human-readable error message
       context: ErrorContext,   // Where the error occurred
       stack_trace: Option<String>, // Stack trace if available
       timestamp: DateTime<Utc>, // When the error occurred
   }

   struct ErrorContext {
       module_path: Option<String>, // Module where error occurred
       file: Option<String>,       // Source file
       line: Option<u32>,          // Line number
       column: Option<u32>,        // Column number
   }
   ```

2. Update the `EventKind` enum implementation:
   ```rust
   pub enum EventKind {
       Start,
       Ping,
       Prompt(String),
       Error(String),
       ErrorOccurred(ErrorDetails),
   }
   ```

3. Add conversion traits to easily create `ErrorDetails` from common error types:
   ```rust
   impl<E: std::error::Error> From<E> for ErrorDetails {
       fn from(error: E) -> Self {
           // Implement conversion logic
       }
   }
   ```

4. Add helper methods for the `Tracker` to simplify error tracking:
   ```rust
   impl Tracker {
       pub async fn track_error<E: Into<ErrorDetails>>(&'static self, error: E) -> Result<()> {
           self.dispatch(EventKind::ErrorOccurred(error.into())).await
       }
   }
   ```

5. Ensure error tracking respects user privacy:
   - Only track errors when the user has opted into tracking
   - Don't include sensitive information in error details
   - Provide clear documentation about what is being tracked

### Notes
- This change should maintain the current opt-out behavior for tracking, ensuring users who have disabled tracking don't have their errors tracked either.
- Care must be taken to ensure error tracking doesn't impact performance.
- Consider adding rate limiting to prevent overwhelming the tracking system during cascading failures.